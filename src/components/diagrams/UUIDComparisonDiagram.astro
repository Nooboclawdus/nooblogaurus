---
// Diagramme: Comparaison UUID v1 vs v4
// Montre la prédictibilité vs aléatoire
---

<div class="diagram-container">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 380" class="uuid-diagram">
    <defs>
      <filter id="glow-red-uuid" x="-20%" y="-20%" width="140%" height="140%">
        <feGaussianBlur stdDeviation="3" result="blur"/>
        <feFlood flood-color="#ef4444" flood-opacity="0.4"/>
        <feComposite in2="blur" operator="in"/>
        <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
      </filter>
      <filter id="glow-green-uuid" x="-20%" y="-20%" width="140%" height="140%">
        <feGaussianBlur stdDeviation="3" result="blur"/>
        <feFlood flood-color="#22c55e" flood-opacity="0.4"/>
        <feComposite in2="blur" operator="in"/>
        <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
      </filter>
      
      <pattern id="grid-uuid" width="25" height="25" patternUnits="userSpaceOnUse">
        <path d="M 25 0 L 0 0 0 25" fill="none" stroke="rgba(100,100,140,0.06)" stroke-width="0.5"/>
      </pattern>
    </defs>
    
    <!-- Background -->
    <rect width="800" height="380" fill="#0c0c14" rx="8"/>
    <rect width="800" height="380" fill="url(#grid-uuid)" rx="8"/>
    
    <!-- Title -->
    <text x="400" y="30" text-anchor="middle" fill="#e2e8f0" font-size="14" font-weight="600">UUID v1 vs v4 : Impact sur les IDOR</text>
    
    <!-- ═══════════════════════════════════════════ -->
    <!-- UUID v1 - VULNERABLE                       -->
    <!-- ═══════════════════════════════════════════ -->
    <g transform="translate(200, 55)">
      <rect x="-170" y="0" width="340" height="280" rx="8" fill="#0f1520" stroke="#ef4444" stroke-width="2" filter="url(#glow-red-uuid)"/>
      
      <!-- Header -->
      <text x="0" y="30" text-anchor="middle" fill="#ef4444" font-size="14" font-weight="700">UUID v1</text>
      <text x="0" y="48" text-anchor="middle" fill="#fca5a5" font-size="10">⚠️ Prédictible</text>
      <line x1="-150" y1="60" x2="150" y2="60" stroke="#7f1d1d" stroke-width="1"/>
      
      <!-- Structure breakdown -->
      <text x="-140" y="85" fill="#94a3b8" font-size="10" font-weight="600">Structure :</text>
      
      <!-- UUID example with color coding -->
      <g transform="translate(0, 105)">
        <rect x="-145" y="-10" width="290" height="28" rx="4" fill="#1a0a0a"/>
        <text x="0" y="8" text-anchor="middle" fill="#94a3b8" font-size="9" font-weight="500" style="font-family: monospace;"><tspan fill="#ef4444">6ba7b810</tspan>-<tspan fill="#f97316">9dad</tspan>-<tspan fill="#eab308">11d1</tspan>-<tspan fill="#22c55e">80b4</tspan>-<tspan fill="#3b82f6">00c04fd430c8</tspan></text>
      </g>
      
      <!-- Legend -->
      <g transform="translate(-130, 140)">
        <rect x="0" y="0" width="12" height="12" rx="2" fill="#ef4444"/>
        <text x="18" y="10" fill="#fca5a5" font-size="9">Timestamp (prévisible)</text>
        
        <rect x="140" y="0" width="12" height="12" rx="2" fill="#3b82f6"/>
        <text x="158" y="10" fill="#93c5fd" font-size="9">MAC address (fixe)</text>
      </g>
      
      <!-- Vulnerability explanation -->
      <g transform="translate(0, 175)">
        <rect x="-140" y="0" width="280" height="85" rx="4" fill="#1f0a0a" stroke="#b91c1c" stroke-width="1"/>
        <text x="0" y="20" text-anchor="middle" fill="#fca5a5" font-size="10" font-weight="600">Problèmes :</text>
        <text x="-125" y="40" fill="#f87171" font-size="9">• Timestamp = ordre de création</text>
        <text x="-125" y="55" fill="#f87171" font-size="9">• MAC = identifie la machine</text>
        <text x="-125" y="70" fill="#f87171" font-size="9">• Énumération triviale (±1 sur timestamp)</text>
      </g>
    </g>
    
    <!-- VS divider -->
    <g transform="translate(400, 195)">
      <circle cx="0" cy="0" r="25" fill="#1e293b" stroke="#475569" stroke-width="2"/>
      <text x="0" y="6" text-anchor="middle" fill="#94a3b8" font-size="12" font-weight="700">VS</text>
    </g>
    
    <!-- ═══════════════════════════════════════════ -->
    <!-- UUID v4 - SECURE                           -->
    <!-- ═══════════════════════════════════════════ -->
    <g transform="translate(600, 55)">
      <rect x="-170" y="0" width="340" height="280" rx="8" fill="#0f1520" stroke="#22c55e" stroke-width="2" filter="url(#glow-green-uuid)"/>
      
      <!-- Header -->
      <text x="0" y="30" text-anchor="middle" fill="#22c55e" font-size="14" font-weight="700">UUID v4</text>
      <text x="0" y="48" text-anchor="middle" fill="#86efac" font-size="10">✓ Aléatoire</text>
      <line x1="-150" y1="60" x2="150" y2="60" stroke="#14532d" stroke-width="1"/>
      
      <!-- Structure breakdown -->
      <text x="-140" y="85" fill="#94a3b8" font-size="10" font-weight="600">Structure :</text>
      
      <!-- UUID example - all random -->
      <g transform="translate(0, 105)">
        <rect x="-145" y="-10" width="290" height="28" rx="4" fill="#0a1a0a"/>
        <text x="0" y="8" text-anchor="middle" fill="#22c55e" font-size="10" font-weight="500" style="font-family: monospace;">f47ac10b-58cc-4372-a567-0e02b2c3d479</text>
      </g>
      
      <!-- Legend -->
      <g transform="translate(-130, 140)">
        <rect x="0" y="0" width="260" height="12" rx="2" fill="#22c55e" opacity="0.3"/>
        <text x="10" y="10" fill="#86efac" font-size="9">122 bits aléatoires (CSPRNG)</text>
      </g>
      
      <!-- Security explanation -->
      <g transform="translate(0, 175)">
        <rect x="-140" y="0" width="280" height="85" rx="4" fill="#052e16" stroke="#15803d" stroke-width="1"/>
        <text x="0" y="20" text-anchor="middle" fill="#86efac" font-size="10" font-weight="600">Avantages :</text>
        <text x="-125" y="40" fill="#4ade80" font-size="9">• Aucune info temporelle</text>
        <text x="-125" y="55" fill="#4ade80" font-size="9">• Aucune info machine</text>
        <text x="-125" y="70" fill="#4ade80" font-size="9">• 2^122 possibilités = inénumérable</text>
      </g>
    </g>
    
    <!-- Bottom note -->
    <text x="400" y="360" text-anchor="middle" fill="#64748b" font-size="10">Note: UUID seul ne suffit pas — toujours vérifier les permissions côté serveur</text>
  </svg>
</div>

<style>
  .diagram-container {
    margin: 2rem 0;
    overflow-x: auto;
    padding: 0.5rem 0;
  }
  
  .uuid-diagram {
    width: 100%;
    min-width: 600px;
    max-width: 800px;
    margin: 0 auto;
    display: block;
  }
</style>
