---
// Diagramme: La mÃ©thode 2-comptes pour tester les IDOR
---

<div class="diagram-container">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 420" class="idor-diagram">
    <defs>
      <!-- Glow filters -->
      <filter id="glow-green" x="-20%" y="-20%" width="140%" height="140%">
        <feGaussianBlur stdDeviation="3" result="blur"/>
        <feFlood flood-color="#22c55e" flood-opacity="0.4"/>
        <feComposite in2="blur" operator="in"/>
        <feMerge>
          <feMergeNode/>
          <feMergeNode in="SourceGraphic"/>
        </feMerge>
      </filter>
      <filter id="glow-red" x="-20%" y="-20%" width="140%" height="140%">
        <feGaussianBlur stdDeviation="3" result="blur"/>
        <feFlood flood-color="#ef4444" flood-opacity="0.4"/>
        <feComposite in2="blur" operator="in"/>
        <feMerge>
          <feMergeNode/>
          <feMergeNode in="SourceGraphic"/>
        </feMerge>
      </filter>
      <filter id="glow-cyan" x="-20%" y="-20%" width="140%" height="140%">
        <feGaussianBlur stdDeviation="3" result="blur"/>
        <feFlood flood-color="#06b6d4" flood-opacity="0.4"/>
        <feComposite in2="blur" operator="in"/>
        <feMerge>
          <feMergeNode/>
          <feMergeNode in="SourceGraphic"/>
        </feMerge>
      </filter>
      <filter id="glow-amber" x="-20%" y="-20%" width="140%" height="140%">
        <feGaussianBlur stdDeviation="3" result="blur"/>
        <feFlood flood-color="#f59e0b" flood-opacity="0.4"/>
        <feComposite in2="blur" operator="in"/>
        <feMerge>
          <feMergeNode/>
          <feMergeNode in="SourceGraphic"/>
        </feMerge>
      </filter>
      
      <!-- Grid pattern -->
      <pattern id="grid-idor" width="30" height="30" patternUnits="userSpaceOnUse">
        <path d="M 30 0 L 0 0 0 30" fill="none" stroke="rgba(100,100,140,0.08)" stroke-width="0.5"/>
      </pattern>
      
      <!-- Arrow marker -->
      <marker id="arrow-idor" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
        <path d="M 0 0 L 10 5 L 0 10 z" fill="#64748b"/>
      </marker>
      <marker id="arrow-green" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
        <path d="M 0 0 L 10 5 L 0 10 z" fill="#22c55e"/>
      </marker>
      <marker id="arrow-red" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
        <path d="M 0 0 L 10 5 L 0 10 z" fill="#ef4444"/>
      </marker>
    </defs>
    
    <!-- Background -->
    <rect width="900" height="420" fill="#0c0c14" rx="8"/>
    <rect width="900" height="420" fill="url(#grid-idor)" rx="8"/>
    
    <!-- Title -->
    <text x="450" y="35" text-anchor="middle" fill="#94a3b8" font-size="14" font-weight="600" letter-spacing="2" style="font-family: monospace;">MÃ‰THODE 2-COMPTES</text>
    
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- COMPTE A - VICTIME (Left)                   -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <g transform="translate(100, 80)">
      <rect x="-80" y="0" width="160" height="65" rx="6" fill="#0f1520" stroke="#22c55e" stroke-width="2" filter="url(#glow-green)"/>
      <text x="0" y="25" text-anchor="middle" fill="#22c55e" font-size="12" font-weight="700" style="font-family: monospace;">COMPTE A</text>
      <text x="0" y="45" text-anchor="middle" fill="#94a3b8" font-size="11">Victime</text>
      
      <!-- Resources -->
      <g transform="translate(0, 85)">
        <rect x="-70" y="0" width="140" height="90" rx="4" fill="#0a0f15" stroke="#1e3a2f" stroke-width="1"/>
        <text x="0" y="20" text-anchor="middle" fill="#4ade80" font-size="9" font-weight="600">RESSOURCES</text>
        <text x="-55" y="40" fill="#64748b" font-size="9" style="font-family: monospace;">user_id: 1337</text>
        <text x="-55" y="55" fill="#64748b" font-size="9" style="font-family: monospace;">doc_id: abc-123</text>
        <text x="-55" y="70" fill="#64748b" font-size="9" style="font-family: monospace;">org_id: 42</text>
      </g>
    </g>
    
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- PROXY (Center)                              -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <g transform="translate(450, 100)">
      <rect x="-90" y="0" width="180" height="70" rx="6" fill="#0f1520" stroke="#06b6d4" stroke-width="2" filter="url(#glow-cyan)"/>
      <text x="0" y="28" text-anchor="middle" fill="#06b6d4" font-size="12" font-weight="700" style="font-family: monospace;">PROXY</text>
      <text x="0" y="48" text-anchor="middle" fill="#94a3b8" font-size="10">Caido / Burp</text>
      
      <!-- Capture indicator -->
      <g transform="translate(0, 85)">
        <rect x="-75" y="0" width="150" height="55" rx="4" fill="#0a0f15" stroke="#164e63" stroke-width="1"/>
        <text x="0" y="20" text-anchor="middle" fill="#22d3ee" font-size="9" font-weight="600">CAPTURE</text>
        <text x="0" y="38" text-anchor="middle" fill="#64748b" font-size="9">Toutes les requÃªtes</text>
        <text x="0" y="50" text-anchor="middle" fill="#64748b" font-size="9">avec IDs notÃ©s</text>
      </g>
    </g>
    
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- COMPTE B - ATTAQUANT (Right)                -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <g transform="translate(800, 80)">
      <rect x="-80" y="0" width="160" height="65" rx="6" fill="#0f1520" stroke="#ef4444" stroke-width="2" filter="url(#glow-red)"/>
      <text x="0" y="25" text-anchor="middle" fill="#ef4444" font-size="12" font-weight="700" style="font-family: monospace;">COMPTE B</text>
      <text x="0" y="45" text-anchor="middle" fill="#94a3b8" font-size="11">Attaquant</text>
      
      <!-- Action -->
      <g transform="translate(0, 85)">
        <rect x="-70" y="0" width="140" height="90" rx="4" fill="#0a0f15" stroke="#3f1515" stroke-width="1"/>
        <text x="0" y="20" text-anchor="middle" fill="#f87171" font-size="9" font-weight="600">TEST</text>
        <text x="0" y="42" text-anchor="middle" fill="#64748b" font-size="9">Rejoue les requÃªtes</text>
        <text x="0" y="57" text-anchor="middle" fill="#64748b" font-size="9">avec son propre token</text>
        <text x="0" y="72" text-anchor="middle" fill="#64748b" font-size="9">sur les IDs de A</text>
      </g>
    </g>
    
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- ARROWS                                      -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- A â†’ Proxy -->
    <path d="M 180 130 L 350 135" stroke="#22c55e" stroke-width="2" fill="none" marker-end="url(#arrow-green)"/>
    <text x="265" y="120" text-anchor="middle" fill="#4ade80" font-size="9" style="font-family: monospace;">1. Navigue</text>
    
    <!-- Proxy â†’ B -->
    <path d="M 550 135 L 710 130" stroke="#ef4444" stroke-width="2" fill="none" marker-end="url(#arrow-red)"/>
    <text x="630" y="120" text-anchor="middle" fill="#f87171" font-size="9" style="font-family: monospace;">2. Teste</text>
    
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- RESULTS (Bottom)                            -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <g transform="translate(450, 290)">
      <text x="0" y="0" text-anchor="middle" fill="#64748b" font-size="10" letter-spacing="2" style="font-family: monospace;">RÃ‰SULTAT</text>
      
      <!-- Arrow down from B -->
      <path d="M 350 -30 L 350 10 L 120 30" stroke="#64748b" stroke-width="1.5" fill="none" stroke-dasharray="4,3"/>
      <path d="M 350 -30 L 350 10 L -120 30" stroke="#64748b" stroke-width="1.5" fill="none" stroke-dasharray="4,3"/>
      
      <!-- IDOR Found -->
      <g transform="translate(-150, 40)">
        <rect x="-100" y="0" width="200" height="60" rx="6" fill="#0f1520" stroke="#ef4444" stroke-width="2" filter="url(#glow-red)"/>
        <text x="0" y="22" text-anchor="middle" fill="#ef4444" font-size="11" font-weight="700" style="font-family: monospace;">200 OK + donnÃ©es de A</text>
        <text x="0" y="42" text-anchor="middle" fill="#f87171" font-size="13" font-weight="700">ðŸŽ¯ IDOR !</text>
      </g>
      
      <!-- Protected -->
      <g transform="translate(150, 40)">
        <rect x="-100" y="0" width="200" height="60" rx="6" fill="#0f1520" stroke="#22c55e" stroke-width="2" filter="url(#glow-green)"/>
        <text x="0" y="22" text-anchor="middle" fill="#22c55e" font-size="11" font-weight="700" style="font-family: monospace;">403 / 404</text>
        <text x="0" y="42" text-anchor="middle" fill="#4ade80" font-size="13" font-weight="700">âœ“ ProtÃ©gÃ©</text>
      </g>
    </g>
  </svg>
</div>

<style>
  .diagram-container {
    margin: 2rem 0;
    overflow-x: auto;
    padding: 1rem 0;
  }
  
  .idor-diagram {
    width: 100%;
    min-width: 700px;
    max-width: 900px;
    margin: 0 auto;
    display: block;
  }
</style>
